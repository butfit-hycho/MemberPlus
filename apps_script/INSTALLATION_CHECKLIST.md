# 📋 Google Apps Script 설치 체크리스트

## ✅ 설치 전 준비사항
- [ ] 구글 계정 로그인 상태 확인
- [ ] 스프레드시트 편집 권한 확인
- [ ] VPN 또는 네트워크 연결 상태 확인 (DB 접근용)

## 🔧 설치 단계별 체크리스트

### 1️⃣ 스프레드시트 준비
- [ ] 기존 스프레드시트 열기 또는 복사
- [ ] 스프레드시트 ID 확인: `1Zi2VmX1Mp2swgC5QlwvAjhndc-MH8SM4YR1TlqNMjm4`

### 2️⃣ Apps Script 에디터 접근
- [ ] 스프레드시트에서 **확장 프로그램 > Apps Script** 클릭
- [ ] Apps Script 에디터 정상 열림 확인

### 3️⃣ 코드 파일 설정
- [ ] 기본 `Code.gs` 파일 내용 삭제
- [ ] `apps_script/Code.gs` 내용 복사 및 붙여넣기
- [ ] **파일 > 새로 만들기 > HTML 파일** 클릭
- [ ] HTML 파일명을 `index`로 설정
- [ ] `apps_script/index.html` 내용 복사 및 붙여넣기

### 4️⃣ 매니페스트 파일 설정
- [ ] **프로젝트 설정** (⚙️) 클릭
- [ ] **매니페스트 파일 표시** 체크박스 활성화
- [ ] `appsscript.json` 파일 내용 삭제
- [ ] `apps_script/appsscript.json` 내용 복사 및 붙여넣기

### 5️⃣ 권한 및 배포 설정
- [ ] **배포 > 새 배포** 클릭
- [ ] **유형** 선택에서 **웹 앱** 선택
- [ ] **액세스 권한** 설정 (나만 또는 조직 내)
- [ ] **배포** 버튼 클릭
- [ ] 배포 성공 메시지 확인

### 6️⃣ API 서비스 활성화
- [ ] **서비스** 탭에서 **Google Sheets API** 추가
- [ ] **리소스 > 고급 Google 서비스** 클릭
- [ ] **Google Sheets API v4** 활성화

### 7️⃣ 데이터베이스 연결 준비
- [ ] **Google Cloud Console** 프로젝트 확인
- [ ] **Google Cloud SQL API** 활성화
- [ ] 서비스 계정 생성 (필요 시)
- [ ] **Cloud SQL 클라이언트** 역할 부여

## 🧪 설치 후 테스트

### 기본 기능 테스트
- [ ] 스프레드시트에서 **유효회원/휴면회원 추출** 메뉴 확인
- [ ] **데이터 추출 시작** 메뉴 클릭
- [ ] 팝업 창 정상 열림 확인
- [ ] **연결 테스트** 버튼 클릭
- [ ] 데이터베이스 연결 성공 메시지 확인

### 지점 목록 테스트
- [ ] **지점 목록 새로고침** 버튼 클릭
- [ ] 지점 드롭다운에 지점 목록 표시 확인
- [ ] "전체" 옵션 포함 여부 확인

### 데이터 추출 테스트
- [ ] 테스트용 지점 선택 (작은 지점 권장)
- [ ] **데이터 추출 시작** 버튼 클릭
- [ ] 진행률 표시 정상 동작 확인
- [ ] 추출 완료 후 결과 표시 확인
- [ ] 새 시트 생성 확인 (유효회원, 휴면회원, 요약)

## ⚠️ 문제 해결 체크리스트

### 연결 오류 시
- [ ] 네트워크 연결 상태 확인
- [ ] VPN 연결 확인 (필요 시)
- [ ] 방화벽 설정 확인
- [ ] DB 서버 상태 확인

### 권한 오류 시
- [ ] 구글 계정 로그인 상태 확인
- [ ] 스프레드시트 편집 권한 확인
- [ ] Apps Script 실행 권한 확인
- [ ] 브라우저 쿠키 및 캐시 삭제

### 시간 초과 오류 시
- [ ] 작은 지점부터 테스트
- [ ] 전체 지점 대신 개별 지점 선택
- [ ] 데이터 범위 축소 고려

### 메모리 부족 오류 시
- [ ] 불필요한 데이터 필터링
- [ ] 배치 처리 구현 고려
- [ ] 지점별 개별 실행

## 🔄 업데이트 체크리스트

### 코드 업데이트 시
- [ ] Apps Script 에디터에서 코드 수정
- [ ] **저장** (Ctrl+S) 실행
- [ ] **배포 > 배포 관리** 클릭
- [ ] **새 버전** 선택 후 **배포** 클릭

### 설정 변경 시
- [ ] 데이터베이스 정보 수정 (`DB_CONFIG`)
- [ ] 스프레드시트 ID 수정 (`SPREADSHEET_ID`)
- [ ] 저장 및 재배포

## 📞 지원 요청 시 준비사항

### 정보 수집
- [ ] 오류 메시지 스크린샷
- [ ] 실행 로그 (Apps Script 에디터 > 실행 내역)
- [ ] 브라우저 콘솔 로그 (F12 > Console)
- [ ] 사용 중인 브라우저 및 버전
- [ ] 네트워크 환경 정보

### 재현 단계
- [ ] 문제 발생 시 수행한 단계 기록
- [ ] 예상 결과 vs 실제 결과 비교
- [ ] 문제 발생 빈도 (항상, 가끔, 특정 조건)

## ✨ 성공적인 설치 확인

모든 체크리스트 완료 후:
- [ ] 스프레드시트 메뉴에서 시스템 실행 가능
- [ ] 지점 선택 및 데이터 추출 정상 동작
- [ ] 결과 시트 자동 생성
- [ ] 진행률 및 상태 메시지 정상 표시
- [ ] 스프레드시트 자동 열기 기능 동작

---

**🎉 축하합니다!** 
모든 체크리스트가 완료되었다면 **유효회원/휴면회원 추출 시스템**이 성공적으로 설치되었습니다. 